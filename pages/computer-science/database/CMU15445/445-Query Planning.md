- Pipe line ![image.jpg](../assets/22a1d6c2-2ed8-47ed-a6f6-2a09963db5f1-1115003.jpg)
- Rule
	- 关系代数的一些运算律：
		- 谓词内推：​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
		- 谓词分解：​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
		- 连接的结合率：​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
		- 连接的交换率：​​​​​​​​​​​​​​​​​​​​​
	- 一些静态规则：当符合某个pattern的时候就下推
		- 投影下推： ![image.jpg](../assets/3f35dc64-a3d1-42f2-bbae-300f688c9fae-1115003.jpg)
		- 谓词分解： ![image.jpg](../assets/ae972d69-0822-46e0-9445-eccdec6ccd31-1115003.jpg)
		- 谓词下推 ![image.jpg](../assets/a57b5bc0-cacc-478e-b5c5-4dd2ad925e21-1115003.jpg)
		- 将带​​​​​​的笛卡尔积转化为内连接<img src="https://api2.mubu.com/v3/document_image/d892730d-c80c-4aa3-bc7e-f5b56ce41660-1115003.jpg" /> ![image.jpg](../assets/ee9fa35c-d9af-4387-a19a-50156fdcf814-1115003.jpg)
		- 子查询优化
			- 重新展开
			- 分解为两个查询
		- 重写表达式
			- 将一些一定为真或为假的表达式删除
			- 纯逻辑上的错误
				- 1 == 0
				- ​​​​​​​​​​​​​​​​​​​​​​​​
			- 利用catalog发现的错误
				- primary key = NULL
				- group by unique key
				- ......
- Cost估计
	- 统计数据：
		- `N`：每个relation总共的tuple数量
		- `V(A, R)`：关系R在attribute `A`中的元素数量
	- Selection Statistics：我们需要估计所selection的元素数量
		- Uniform：平均估计
			- ​​​​​​​​​​​​​​​​​​​​​​​​​
			- ​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
			- ...
		- 等宽直方图：维护麻烦
			- 数据在整体上不是uniform的但是局部是的<img src="https://api2.mubu.com/v3/document_image/51d31e39-9eb4-4b94-8519-a9134fdf7289-1115003.jpg" /> ![image.jpg](../assets/a01d7aca-4f8f-482c-9d24-af33935b8be0-1115003.jpg)
		- 等深直方图：维护麻烦
			- 直方图的深度相等：不知道能解决什么问题 ![image.jpg](../assets/4e5b12f6-bff0-4616-8ac7-b7d8f9fcc8a0-1115003.jpg)
		- 抽样：通过样本估计整体
			- 维护简单
			- 但是需要遍历整个小样本
- 搜索
	- 单个relation：启发式的，贪婪的选最好的
	- 多个relation，比如​​​​​​​​​​​​​​​​​​​​​
		- 搜索的空间
			- 连接的顺序
			- 连接的方式：sort/hash
		- 通过动态规划
- 还有很多搞不清楚